<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>黄帝内经养生六合图</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>    
    <style>
        @font-face {
            font-family: 'Aa古典刻本宋';
            src: url("fonts/AaGuDianKeBenSong-2.ttf") format('truetype');           
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Aa美人篆';
            src: url("fonts/AaMeirenzhuan.woff") format('woff');           
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Aa极简护眼 挽风宋体';
            src: url("fonts/AaJJHYWFST.woff") format('woff');            
            font-weight: normal;
            font-style: normal;
        }  
        @keyframes galaxyRotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }          
        #chart {          
            width: 100vw;
            height: 100vh;                        
            background: url(images/background1.jpg)center/cover no-repeat;;
        }
        body{
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #adviceBox {
            display: none;
            position: fixed;
            background: #fff9e6;
            border: 2px solid #a19d6e;
            padding: 0.9375rem;
            border-radius: 0.5rem;
            max-width: 20.625rem;
            box-shadow: 0.1875rem 0.1875rem 0.3125rem rgba(0,0,0,0.2);
            color: #68553A;
            font-size: 0.8rem;
            line-height: 1.6;
            z-index: 1000;
            font-family: 'Aa古典刻本宋', sans-serif;
            pointer-events: none; /* 防止提示框阻挡点击 */
        }
        /* 飘落花瓣动画 */
        .petal {
            position: absolute;
            top: 100px;
            left: 100px;
            width: 18px;
            height: 18px;
            background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill="%23DEB887" d="M10 0c2,4 3,8 2,12-1,4-4,7-8,8-4-1-7-4-8-8C-1,8 0,4 2,0c3,3 5,5 8,8z"/></svg>');
            opacity: 0.6;
            pointer-events: none;
            animation: fall linear infinite;
        }
        /* 提示框入场动画 */
        #adviceBox {
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            opacity: 0;
            transform: scale(0.8);
        }
        #adviceBox.show {
            opacity: 1;
            transform: scale(1);
        }
        @keyframes fall {
            0% { transform: translateY(-10vh) rotate(0deg); }
            100% { transform: translateY(110vh) rotate(360deg); }
        }
        .highlight-text {
            text-shadow: 0 0 0px rgba(161, 157, 110, 0.5);
        }
        #legend {
            position: fixed;
            top: clamp(1.5rem, 6vh, 4rem);;
            right: clamp(1rem, 3vw, 4rem);
            width:10 rem;
            max-width: 50vw;
            background: #FBEEDE;
            padding:  clamp(0.5rem, 1.25vmin, 1rem);
            border-radius: clamp(0.25rem, 0.8vmin, 0.5rem);
            border: 1px solid #a4a181;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin:clamp(0.5rem, 0.6vmin, 0.375rem) 0;
            font-family: 'Aa古典刻本宋', sans-serif;
            color: #68553A;
            transition: all 0.3s ease;
            cursor: pointer;
            padding: 
            clamp(0.3rem, 0.5vmin, 0.6rem)
            clamp(0.75rem, 2.5vmin, 1.5rem);
            border-radius: 4px;
            font-size: clamp(0.975rem, 2.6vmin, 1.325rem);
            
        }
        .legend-item:hover {
            background: rgba(161, 157, 110, 0.1);
            transform: translateX(-5px);
        }
        .legend-item.active {
            background: rgba(161, 157, 110, 0.2);
            position: relative;
        }
        .legend-color {
            width: clamp(1.125rem, 3vmin, 1.5rem);
            height: clamp(1.125rem, 3vmin, 1.5rem);
            margin-right: clamp(0.5rem, 1.5vmin, 1rem);
            border-radius: 4px;
            border: 1px solid rgba(161, 157, 110, 0.3);
        }       
        /*二十四节气养生指南样式 */
        .seasonal-guide {
            position: fixed;            
            right: calc(100% - clamp(15rem, 19vw, 25rem));
            left: clamp(1rem, 12vw, 26rem); /* 左侧定位 */
            bottom: clamp(2rem, 9vh, 15rem);
            width: clamp(12rem, 10vw, 22rem); 
            height: auto; /* 高度自适应 */
            max-height: 80vh; /* 防止溢出 */            
            transform: translateX(-50%); /* 居中修正 */
            z-index: 1000;
            color:#68553A;
            font-family: 'Aa古典刻本宋', 'SimSun'; 
        }        
        .seasonal-guide table {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: clamp(0.25rem, 0.5vmin, 0.75rem);
            padding: 0.75rem;
            width: 100%;
            border-collapse: collapse;
            font-size: 15px;
        }        
        .seasonal-guide td {           
            padding: 0.4375rem;
            margin: 0.125rem;
            border-radius: 0.375rem;
            text-align: center;
            font-size: clamp(0.475rem, 1.0vmin, 1.75rem);
            color: #635815;
            font-weight:'bold' ;            
            cursor: pointer;
            position: relative;
            transition: z-index 0.001s; /* 强制层级变化触发重排 */
            will-change: transform, z-index; /* 优化动画性能 */
            position: relative;
            border: 2px solid rgba(255,255,255,0.3) !important;
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background-image: linear-gradient(145deg, 
                rgba(255,255,255,0.1) 0%,
                rgba(255,255,255,0.05) 50%,
                rgba(0,0,0,0.05) 100%) !important;
            box-shadow: 
             0 2px 8px rgba(0,0,0,0.1),
             inset 0 1px 0 rgba(255,255,255,0.2);  
            filter: 
             url(#paperTexture) /* SVG纹理滤镜 */
             contrast(1.1) 
             brightness(0.98); 
             overflow: visible !important;    
             isolation: isolate; /* 创建新的层叠上下文 */     
        }
        /* 书签顶部的传统纹样装饰 */
        .seasonal-guide td::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 50%;
            width: 100%;
            height: 0.75rem;
            background: 
            linear-gradient(90deg, 
            transparent 15%, 
            rgba(255,228,181,0.8) 30%, 
            #FFE4B5 50%, 
            rgba(255,228,181,0.8) 70%, 
            transparent 85%);
            transform: translateX(-50%);
            clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);
        }
        /* 书签底部的流苏效果 */
        .seasonal-guide td::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            width: 1.25rem;
            height: 1rem;
            background: 
                radial-gradient(circle, 
                    rgba(255,228,181,0.8) 30%, 
                    transparent 70%),
                repeating-linear-gradient(-45deg,
                    transparent 0 2px,
                    rgba(255,228,181,0.6) 2px 4px);
            transform: translateX(-50%);
            clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
        }
        /* 悬停动画 */
        .seasonal-guide td:hover {
            transform: translateY(-5px) rotate(2deg);
            box-shadow: 
                0 8px 20px rgba(0,0,0,0.2),
                inset 0 2px 0 rgba(255,255,255,0.3);
        }
        .spring-1 { background-color: #f4d897; }
        .spring-2 { background-color: #f4d897; }
        .spring-3 { background-color: #f4d897; }
        .spring-4 { background-color: #f4d897; }
        .summer-1 { background-color: #b48c3d; }
        .summer-2 { background-color: #b48c3d; }
        .summer-3 { background-color: #b48c3d; }
        .summer-4 { background-color: #b48c3d; }
        .autumn-1 { background-color: #ebbf58; }
        .autumn-2 { background-color: #ebbf58; }
        .autumn-3 { background-color: #ebbf58; }
        .autumn-4 { background-color: #ebbf58; }
        .winter-1 { background-color: #a3854d; }
        .winter-2 { background-color: #a3854d; }
        .winter-3 { background-color: #a3854d; }
        .winter-4 { background-color: #a3854d; }
        
        .seasonal-guide .title {
            font-weight: bold;
            font-size: 2.0vmin;
            font-family: 'Aa古典刻本宋', sans-serif;
        }
        
        .seasonal-guide .subtitle {
            font-size:  1.3vmin;
            font-family: 'Aa古典刻本宋', sans-serif;            
        }
        
        .seasonal-guide .tooltip {
            position: fixed;
            background-color: #fff9e6;
            color: #68553A;           
            line-height: 1.6;
            z-index: 2147483647 !important; 
            font-family: 'Aa古典刻本宋', sans-serif;
            pointer-events: none; /* 防止提示框阻挡点击 */
            padding: 6px;
            border-radius: 10px;
            font-size: 10px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;           
            top :90px;
            width: 100px;
            position: fixed !important;
            z-index: 2147483647 !important; /* 最大层级 */
            opacity: 0;
            transition: opacity 0.3s;
            text-align: left; /* 添加左对齐 */
        }
        
        .seasonal-guide td:hover .tooltip {
            opacity: 1 !important;
        }

        /* 添加GPU加速 */
        .seasonal-guide td {
            transform: translateZ(0);
            will-change: transform, z-index;
        }

        .tooltip {
            transform: translateZ(1px);
            backdrop-filter: blur(2px);
        }

        .nav-icon {
            position: fixed;
            left: 1.25rem;
            top: 2.2rem;
            width: 4rem;
            height: 3rem;
            cursor: pointer;
            z-index: 1003; /* 导航最高层级 */
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            background: url('images/daohang4.png') center/contain no-repeat; /* 自定义图标 */
        }
        .nav-icon:hover {
            transform: scale(0.9);
        }
        /* Three.js画布层级控制 */
        canvas {
            z-index: 1 !important;
            pointer-events: auto !important;
        }
        
        /* 侧边菜单 */
        .side-menu {
            position: fixed;
            left: -45rem;
            top: 1.875rem;
            background: rgba(237, 217, 180, 0.6);
            padding: 0.4rem 0.7rem;
            border-radius: 0.625rem;
            box-shadow: none;
            transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1002; 
            display: flex;
            flex-direction: row; 
            gap: 0; 
            align-items: center;
        }
        .side-menu.active {
            left: 5.6rem;
        }
        .side-menu a {
        position: relative;
        font-family: 'Aa极简护眼 挽风宋体';
        font-weight: bold !important;
        font-size: 1.5rem;
        color: #68340f;
        text-decoration: none;
        white-space: nowrap;
        padding: 0.375rem 0.9375rem;
        border-radius: 5px;
        transition: 0.3s;
    }
        /* 为除最后一个菜单项外的所有项添加右侧竖线 */
        .side-menu a:not(:last-child)::after {
        content: "";
        position: absolute;
        right: -0.3125rem; /* 根据gap值调整位置 */
        font-weight: bold !important;
        top: 50%;
        transform: translateY(-50%);
        width: 0.1rem;
        height: 60%; /* 控制竖线高度为字高的60% */
        background-color: #4c3832;
        opacity: 0.6;
        }
    </style>
</head>
<body>
    <div class="nav-icon" id="navTrigger"></div>
    <div class="side-menu" id="sideMenu">
        <a href="index.html">首页</a>
        <a href="sunburt.html">病机玄钥</a>
        <a href="Ahealth.html">顺时养元</a>
        <a href="wuxing.html">五行五脏</a>
        <a href="history.html">岐黄溯古</a>
    </div>
    <div id="chart"></div>
    <div id="legend">
        <div class="legend-item">
            <div class="legend-color" style="background:#fef1cb;"></div>
            <span>核心理论层</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:#efd5a2"></div>
            <span>基础理论层</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:#c79d4e"></div>
            <span>养生原则层</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:#f3e4aa"></div>
            <span>方法体系层</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:#e1b754"></div>
            <span>实践应用层</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:#816734"></div>
            <span>自然疗法层</span>
        </div>
    </div>
    <div id="adviceBox"></div>
    
    <!-- 二十四节气养生指南 -->
    <div class="seasonal-guide">
        <h3 style="position: absolute; top: 10px; left: -45px;writing-mode: vertical-lr;font-size: 20px;">二十四节气·顺时养生指南</h3>

        <table>
            <tr>
                <td class="spring-1">
                    <p class="title">立春</p>
                    <p class="subtitle">养肝明目</p>
                    <div class="tooltip">立春养生：早睡早起，多晒太阳，多吃绿色蔬菜，如菠菜、韭菜等，有助于肝脏健康。</div>
                </td>
                <td class="spring-2">
                    <p class="title">雨水</p>
                    <p class="subtitle">和肝养胃</p>
                    <div class="tooltip">雨水养生：注意保暖，避免受寒，多吃健脾养胃食物，如山药、薏米、莲子等。</div>
                </td>
                <td class="spring-3">
                    <p class="title">惊蛰</p>
                    <p class="subtitle">养阳养肝</p>
                    <div class="tooltip">惊蛰养生：多食梨、枇杷等水果，有助于清肝养阳，避免食用过于辛辣的食物。</div>
                </td>
                <td class="spring-4">
                    <p class="title">春分</p>
                    <p class="subtitle">疏肝解郁</p>
                    <div class="tooltip">春分养生：多进行户外活动，如踏青、放风筝等，有助于舒缓情绪，疏解肝郁。</div>
                </td>
                <td class="spring-4">
                    <p class="title">清明</p>
                    <p class="subtitle">柔肝养肺</p>
                    <div class="tooltip">清明养生：多吃清淡食物，如绿豆、豆腐等，有助于柔肝养肺，避免过度劳累。</div>
                </td>
                <td class="spring-3">
                    <p class="title">谷雨</p>
                    <p class="subtitle">补血益气</p>
                    <div class="tooltip">谷雨养生：多食红枣、桂圆等补血益气的食物，有助于增强体质。</div>
                </td>
            </tr>
            <tr>
                
                <td class="summer-1" style="color: white;">
                    <p class="title">立夏</p>
                    <p class="subtitle">补肾助肝</p>
                    <div class="tooltip">立夏养生：适当增加午休时间，多吃黑色食物，如黑豆、黑芝麻等，有助于补肾助肝。</div>
                </td>
                <td class="summer-2" style="color: white;">
                    <p class="title">小满</p>
                    <p class="subtitle">健脾化湿</p>
                    <div class="tooltip">小满养生：多吃健脾利湿食物，如赤小豆、扁豆等，避免食用过于油腻的食物。</div>
                </td>
                <td class="summer-3" style="color: white;">
                    <p class="title">芒种</p>
                    <p class="subtitle">益肝补肾</p>
                    <div class="tooltip">芒种养生：多食枸杞、桑葚等滋补肝肾的食物，有助于增强体质。</div>
                </td>
                <td class="summer-4" style="color: white;">
                    <p class="title">夏至</p>
                    <p class="subtitle">健脾养心</p>
                    <div class="tooltip">夏至养生：多吃红豆、莲子、莲藕等健脾养心的食物，避免过度情绪波动。</div>
                </td>
                <td class="summer-3" style="color: white;">
                    <p class="title">小暑</p>
                    <p class="subtitle">静心安神</p>
                    <div class="tooltip">小暑养生：保持心情舒畅，多进行一些轻松的活动，如听音乐、冥想、阅读等。</div>
                </td>
                <td class="summer-2" style="color: white;">
                    <p class="title">大暑</p>
                    <p class="subtitle">清凉滋阴</p>
                    <div class="tooltip">大暑养生：多吃清凉滋阴的食物，如西瓜、冬瓜等，避免中暑。</div>
                </td>
            </tr>
            <tr>
                <td class="autumn-1">
                    <p class="title">立秋</p>
                    <p class="subtitle">益胃生津</p>
                    <div class="tooltip">立秋养生：多吃润燥生津的食物，如梨、百合等，有助于益胃生津。</div>
                </td>
                <td class="autumn-2">
                    <p class="title">处暑</p>
                    <p class="subtitle">滋阴润燥</p>
                    <div class="tooltip">处暑养生：多食银耳、蜂蜜等滋阴润燥的食物，避免食用过于辛辣的食物。</div>
                </td>
                <td class="autumn-3">
                    <p class="title">白露</p>
                    <p class="subtitle">生津润肺</p>
                    <div class="tooltip">白露养生：多吃白色食物，如萝卜、百合等，有助于生津润肺。</div>
                </td>
                <td class="autumn-4">
                    <p class="title">秋分</p>
                    <p class="subtitle">调胃健脾</p>
                    <div class="tooltip">秋分养生：注意保暖，多吃健脾养胃的食物，如山药、南瓜等。</div>
                </td>
                <td class="autumn-4">
                    <p class="title">寒露</p>
                    <p class="subtitle">滋阴降燥</p>
                    <div class="tooltip">寒露养生：多食滋阴降燥的食物，如芝麻、杏仁等，避免食用过于辛辣的食物。</div>
                </td>
                <td class="autumn-3">
                    <p class="title">霜降</p>
                    <p class="subtitle">滋补肾气</p>
                    <div class="tooltip">霜降养生：多吃黑色食物，如黑豆、黑芝麻等，有助于滋补肾气。</div>
                </td>
            </tr>
            <tr>
                
                <td class="winter-1" style="color: white;">
                    <p class="title">立冬</p>
                    <p class="subtitle">养肾补血</p>
                    <div class="tooltip">立冬养生：适当增加睡眠时间，多吃红枣、桂圆等补血养肾的食物。</div>
                </td>
                <td class="winter-2" style="color: white;">
                    <p class="title">小雪</p>
                    <p class="subtitle">补气填精</p>
                    <div class="tooltip">小雪养生：多食温热食物，如羊肉、核桃等，有助于补气填精。</div>
                </td>
                <td class="winter-3" style="color: white;">
                    <p class="title">大雪</p>
                    <p class="subtitle">活血通脉</p>
                    <div class="tooltip">大雪养生：多进行室内运动，如瑜伽、太极拳等，有助于活血通脉。</div>
                </td>
                <td class="winter-4" style="color: white;">
                    <p class="title">冬至</p>
                    <p class="subtitle">扶元固本</p>
                    <div class="tooltip">冬至养生：多吃温补食物，如羊肉、狗肉等，有助于扶元固本。</div>
                </td>
                <td class="winter-3" style="color: white;">
                    <p class="title">小寒</p>
                    <p class="subtitle">益气补虚</p>
                    <div class="tooltip">小寒养生：注意保暖，多吃温热食物，如姜汤、红枣等，有助于益气补虚。</div>
                </td>
                <td class="winter-2" style="color: white;">
                    <p class="title">大寒 </p>
                    <p class="subtitle">补脾益气</p>
                    <div class="tooltip">大寒养生：多吃健脾益气的食物，如山药、薏米等，避免过度劳累。</div>
                </td>
            </tr>
        </table>       
    </div>

    <script type="text/javascript">
        // 添加在chart初始化之前
const DESIGN_WIDTH = 1920;
const DESIGN_HEIGHT = 1080;

function calcPosition(val, isY = false) {
    const chartDom = document.getElementById('chart');
    const baseSize = isY ? chartDom.offsetHeight : chartDom.offsetWidth;
    const designSize = isY ? DESIGN_HEIGHT : DESIGN_WIDTH;
    return (val / designSize) * baseSize;
}

function calcDimension(val, isHeight = false) {
    const chartDom = document.getElementById('chart');
    const baseSize = isHeight ? chartDom.offsetHeight : chartDom.offsetWidth;
    const designSize = isHeight ? DESIGN_HEIGHT : DESIGN_WIDTH;
    return Math.max((val / designSize) * baseSize, 20);
}
        var chart = echarts.init(document.getElementById('chart'));               
        var option = {
            graphic: [                                              
            {                                    
                type: 'image',               
                style: {
                    image: "images/ys-y.png", 
                    x: calcPosition(1530), 
                    y: calcPosition(500), 
                    width: calcPosition(400), 
                    height: calcPosition(450,true),
                    opacity: 0.7
                },
                z: 100            
        }],                        
            tooltip: { show: false },
            legend: { show: false },
            series: [
                {  // 核心层（最内层）
                    name: '养生之道',
                    type: 'pie',
                    radius: [, '26%'],
                    color: '#fef1cb',
                    itemStyle: { 
                        borderWidth: 2, 
                        borderColor: '#ffff',
                    },
                    label: {
                        show: true,
                        position: 'center',
                        color: '#8B4513',
                        fontSize: 'clamp(2rem, 2.8vw, 6.5rem)',
                        fontFamily:'Aa美人篆',
                        fontWeight: 'bold',
                        formatter: '{b}',
                        textBorderColor: '#fff',
                        textBorderWidth: 2,
                        lineHeight: 48
                    },
                    data: [{ value: 1, name: '黄帝内经\n养生之道' }]
                },
                {  // 基础理论层
                    name: '理论体系',
                    type: 'pie',
                    radius: ['26%', '38%'],
                    color:  '#efd5a2',
                    itemStyle: { 
                        borderWidth: 2, 
                        borderColor: '#ffff',
                    },
                    label: {
                        show: true,
                        position: 'inside',
                        color: '#68553A',                       
                        fontWeight: 'bold',
                        fontSize: 'clamp(0.975rem, 2.7vmin, 1.325rem)',
                        fontFamily:'Aa古典刻本宋',
                        formatter: '{b}',
                        textBorderColor: '#fff',
                        textBorderWidth: 1,
                        lineHeight: 20,
                        rotate: 'tangential',
                    },
                    data: [
                        { value: 1, name: '脏象学说' },
                        { value: 1, name: '经络理论' },
                        { value: 1, name: '气血津液' },
                        { value: 1, name: '病因病机' },
                        { value: 1, name: '诊法治则' }
                    ]
                },
                {  // 养生原则层
                    name: '养生原则',
                    type: 'pie',
                    radius: ['38%', '50%'],
                    color: '#c79d4e',
                    itemStyle: { 
                        borderWidth: 2, 
                        borderColor: '#ffff',
                    },
                    label: {
                        show: true,
                        position: 'inside',
                        color: '#fff',
                        fontSize: 'clamp(0.975rem, 2.7vmin, 1.325rem)',
                        fontFamily:'Aa古典刻本宋',
                        fontWeight: 'bold',
                        formatter: '{b}',
                        textBorderColor: '#68553A',
                        textBorderWidth: 2,
                        rotate: 'tangential',
                        distance: 30
                    },
                    labelLine: { show: true, length: 30 },
                    data: [
                        { value: 1, name: '法于阴阳' },
                        { value: 1, name: '和于术数' },
                        { value: 1, name: '食饮有节' },
                        { value: 1, name: '起居有常' },
                        { value: 1, name: '不妄作劳' },
                        { value: 1, name: '形神兼养' }
                    ]
                },
                {  // 方法体系层
                    name: '方法体系',
                    type: 'pie',
                    radius: ['56%', '68%'],
                    color: '#f3e4aa',
                    itemStyle: { 
                        borderWidth: 2, 
                        borderColor: '#ffff',
                    },
                    label: {
                        show: true,
                        position: 'inside',
                        color: '#68553A',
                        fontSize: 'clamp(0.975rem, 2.7vmin, 1.325rem)',
                        fontFamily:'Aa古典刻本宋',
                        fontWeight: 'bold',
                        formatter: '{b}',
                        textBorderColor: '#fff',
                        textBorderWidth: 1,
                        lineHeight: 20,
                        rotate: 'tangential'
                    },
                    data: [
                        { value: 1, name: '导引按跷' },
                        { value: 1, name: '针灸推拿' },
                        { value: 1, name: '药膳食疗' },
                        { value: 1, name: '情志调摄' },
                        { value: 1, name: '节气养生' },
                        { value: 1, name: '环境养生' },
                        { value: 1, name: '音乐疗法' },
                        { value: 1, name: '香薰疗法' }
                    ]
                },
                {  // 实践应用层
                    name: '养生实践',
                    type: 'pie',
                    radius: ['68%', '80%'],
                    color: '#e1b754',
                    itemStyle: { 
                        borderWidth: 2, 
                        borderColor: '#ffff',
                    },
                    label: {
                        show: true,
                        position: 'inside',
                        color: '#fff',
                        fontSize:'clamp(0.975rem, 2.7vmin, 1.325rem)',
                        fontFamily:'Aa古典刻本宋',
                        fontWeight: 'bold',
                        formatter: '{b}',
                        textBorderColor: '#68553A',
                        textBorderWidth: 1,
                        lineHeight: 20,
                        rotate: 'tangential'
                    },
                    data: [
                        { value: 1, name: '八段锦' },
                        { value: 1, name: '五禽戏' },
                        { value: 1, name: '太极拳' },
                        { value: 1, name: '易筋经' },
                        { value: 1, name: '六字诀' },
                        { value: 1, name: '站桩功' },
                        { value: 1, name: '穴位按摩' },
                        { value: 1, name: '艾灸疗法' },
                        { value: 1, name: '砭石疗法' },
                        { value: 1, name: '药浴熏蒸' }
                    ]
                },
                {  // 自然疗法层
                    name: '自然疗法',
                    type: 'pie',
                    radius: ['80%', '92%'],
                    color: '#816734',
                    itemStyle: { 
                        borderWidth: 2, 
                        borderColor: '#ffff',
                    },
                    label: {
                        show: true,
                        position: 'outside',
                        color: '#68553A',
                        fontSize: 'clamp(0.975rem, 2.7vmin, 1.325rem)',
                        fontFamily:'Aa古典刻本宋',
                        fontWeight: 'bold',
                        formatter: '{b}',
                        textBorderColor: '#fff',
                        textBorderWidth: 2,
                        rotate: 'tangential',
                        distance: 30
                    },
                    labelLine: { show: true, length: 10 },
                    data: [
                        { value: 1, name: '山林养生' },
                        { value: 1, name: '湖畔养生' },
                        { value: 1, name: '海滨养生' },
                        { value: 1, name: '温泉养生' },
                        { value: 1, name: '日光疗法' },
                        { value: 1, name: '月光疗法' },
                        { value: 1, name: '地磁养生' },
                        { value: 1, name: '节气食疗' },
                        { value: 1, name: '花茶调理' },
                        { value: 1, name: '药枕疗法' },
                        { value: 1, name: '芳香疗法' },
                        { value: 1, name: '色彩疗法' }
                    ]
                }
            ],
            
        };

        let originalColors = new Map(); // 保存原始颜色
        let currentHighlight = null;    // 当前高亮元素
        // 养生数据
        const adviceData = {
            // 核心层
            '黄帝内经\n养生之道': '顺应自然规律，强调天人合一。通过精神调摄、饮食调理、起居有常、运动养生等综合方法，达到预防疾病、延年益寿的目的。',

            // 基础理论层
            '脏象学说': '注重内脏功能与外在表现的关联，通过观察面色、舌苔等体征判断脏腑健康状况。定期进行中医体质辨识。',
            '经络理论': '保持经络畅通，可通过拍打经络、穴位按摩等方式调理。每日晨起可沿心包经循行路线轻拍3分钟。',
            '气血津液': '保持气血调和，阳虚者可适当艾灸关元穴，阴虚者可用麦冬、石斛代茶饮。',
            '病因病机': '注重七情致病特点，保持情绪平和。怒伤肝者可练习嘘字诀，思伤脾者可练习呼字诀。',
            '诊法治则': '定期观察舌象变化，舌苔厚腻者可增加运动量，舌质暗紫者可适量饮用玫瑰花茶。',

            // 养生原则层
            '法于阴阳': '春季晚睡早起，夏季午时小憩，秋季早卧早起，冬季早睡晚起。冬至前后可艾灸神阙穴培补元气。',
            '和于术数': '选择适合自己的养生功法，阳虚体质宜练八段锦，气郁体质宜练六字诀，痰湿体质宜练五禽戏。',
            '食饮有节': '春季多食芽菜（豆芽、香椿），夏季多食瓜类（冬瓜、苦瓜），秋季多食根茎（山药、萝卜），冬季多食坚果（核桃、板栗）。',
            '起居有常': '保持子时（23-1点）深睡眠，午时（11-13点）小憩30分钟。睡前可用吴茱萸粉醋调敷涌泉穴改善睡眠。',
            '不妄作劳': '运动养生遵循"三五七"原则：每天步行3公里以上，每周运动5次，运动时心率达到（170-年龄）次/分钟。',
            '形神兼养': '晨起练习站桩功培养元气，午后练习书法宁神静气，傍晚散步疏解压力。',

            // 方法体系层
            '导引按跷': '晨起练习"理三焦"手法：双手托天理三焦10次，配合深呼吸。久坐后可按揉后溪穴缓解肩颈僵硬。',
            '针灸推拿': '春季可针刺太冲穴疏肝，夏季艾灸中脘穴健脾，秋季按揉太渊穴润肺，冬季温灸关元穴补肾。',
            '药膳食疗': '根据体质选择药膳：气虚用四君子汤，血虚用四物汤，阴虚用沙参麦冬汤，阳虚用理中汤。',
            '情志调摄': '采用情志相胜法：思虑过度者培养兴趣爱好（喜胜思），悲伤情绪可闻檀香（香佩疗法）。',
            '节气养生': '立春时节敲打胆经，清明时节练习"嘘"字诀，夏至时节艾灸中脘，冬至前后膏方进补。',
            '环境养生': '居室布置遵循"四象"原则：左青龙（绿植）、右白虎（矮柜）、前朱雀（开阔）、后玄武（靠山）。',
            '音乐疗法': '肝气郁结可听《胡笳十八拍》，心火旺盛可听《紫竹调》，脾胃不和可听《十面埋伏》，肾气不足可听《梅花三弄》。',
            '香薰疗法': '春季用玫瑰薄荷香薰疏肝，夏季用茉莉菊花香薰清心，秋季用桂花陈皮香薰润肺，冬季用肉桂丁香香薰暖肾。',

            // 实践应用层
            '八段锦': '重点练习"双手托天理三焦"和"调理脾胃须单举"，每式重复9次为一组，每日3组。',
            '五禽戏': '虎戏重点锻炼腰脊，鹿戏增强腰部力量，熊戏调理脾胃，猿戏提高灵敏，鸟戏强化呼吸。',
            '太极拳': '晨练时重点练习云手式，配合逆腹式呼吸，动作与呼吸比例保持1:3（动作1拍，呼吸3拍）。',
            '易筋经': '练习"倒拽九牛尾"时注意腰马合一，"三盘落地"式保持膝关节不超过脚尖。',
            '六字诀': '肝病练"嘘"，心病练"呵"，脾病练"呼"，肺病练"呬"，肾病练"吹"，三焦练"嘻"。',
            '站桩功': '采用养生桩：两脚与肩同宽，膝盖微曲，双手环抱胸前如抱球，每次站15-30分钟。',
            '穴位按摩': '感冒初起按揉风池穴，头痛按太阳穴，胃痛按足三里，失眠按神门穴，每个穴位点按3分钟。',
            '艾灸疗法': '保健灸法：每月初一至初七灸足三里，初八至十四灸中脘，十五至廿一灸关元，廿二至廿八灸涌泉。',
            '砭石疗法': '肩颈疼痛可用砭石刮痧板沿膀胱经刮拭，下肢水肿可用砭石点按三阴交、阴陵泉。',
            '药浴熏蒸': '风寒感冒用紫苏叶30g+生姜50g煮水泡脚，关节疼痛用艾叶30g+红花15g煮水熏洗。',

            // 自然疗法层
            '山林养生': '选择松柏林区进行森林浴，上午9-11点最佳，配合深呼吸练习，每次60-90分钟。',
            '湖畔养生': '湖边练习"六字诀"中的"呬"字诀，面向水面进行发声练习，有助于润肺清燥。',
            '海滨养生': '沙滩赤足行走，速度以每分钟90步为宜，配合脚趾抓地动作，每次20分钟。',
            '温泉养生': '硫磺泉适合皮肤疾患，碳酸泉适合心血管养护，铁泉适合贫血人群，每次浸泡不超过15分钟。',
            '日光疗法': '背部日光浴最佳时段为上午9-10点，注意保护头部，晒至全身温暖微汗即可。',
            '月光疗法': '满月前后三日，夜晚静坐时面向月亮，意念集中于丹田，配合深呼吸36次。',
            '地磁养生': '睡眠时保持头北脚南方向，使用天然材质的寝具（棉麻、丝绸），避免电子设备干扰。',
            '节气食疗': '立春食用春饼（含辛香蔬菜），清明吃青团（艾草制），冬至服用当归生姜羊肉汤。',
            '花茶调理': '春饮茉莉（疏肝），夏饮荷花（清心），秋饮菊花（润肺），冬饮梅花（温肾）。',
            '药枕疗法': '失眠用决明子枕，高血压用菊花枕，颈椎病用艾叶枕，过敏性鼻炎用辛夷花枕。',
            '芳香疗法': '晨起用迷迭香精油提神，午后用柠檬精油专注，晚间用薰衣草精油助眠。',
            '色彩疗法': '烦躁时凝视绿色植物，抑郁时穿着暖色衣物，消化不良时布置黄色餐桌装饰。'
        };

        option.series.forEach(series => {
            series.data.forEach(item => {
                item.advice = adviceData[item.name];
            });
        });

        chart.setOption(option);
        
        chart.on('click', params => {
            const adviceBox = document.getElementById('adviceBox');
            if (params.data?.advice) {
                adviceBox.innerHTML = `<h3 style="margin:0 0 10px 0;color:#9C8C6B">${params.name}</h3>${params.data.advice}`;
                adviceBox.style.display = 'block';
                // 使用浏览器窗口坐标
                const x = params.event.event.clientX + 15;
                const y = params.event.event.clientY + 15;
                // 防止提示框超出视口
                const maxX = window.innerWidth - adviceBox.offsetWidth - 20;
                const maxY = window.innerHeight - adviceBox.offsetHeight - 20;
                adviceBox.style.left = Math.min(x, maxX) + 'px';
                adviceBox.style.top = Math.min(y, maxY) + 'px';
            }
        });

        // 窗口调整时重绘图表
        window.addEventListener('resize', () => chart.resize());
        // 初始化时创建花瓣
        function createPetals() {
            const container = document.body;
            for(let i=0; i<15; i++) {
                const petal = document.createElement('div');
                petal.className = 'petal';
                petal.style.left = Math.random() * 100 + 'vw';
                petal.style.animationDuration = Math.random() * 3 + 5 + 's';
                petal.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(petal);
            }
        }
        createPetals();

        // 增强图表交互效果
        option.series.forEach(series => {
            // 设置强调样式
            series.emphasis = {
                itemStyle: {
                    shadowBlur: 20,
                    shadowColor: 'rgba(0, 0, 0, 0.2)'
                },
                label: {
                    show: true,
                    fontSize: series.label.fontSize + 2,                   
                }
            };
                   
         // 添加涟漪动画
        series.data.forEach(item => {
         item.itemStyle = {
         ...item.itemStyle,
         borderRadius: 10,
        decal: {
        symbol: 'circle',
         dashArrayX: [1, 0],
         dashArrayY: [2, 5],
         symbolSize: 0.8,
         color: 'rgba(255,255,255,0.3)'
         }
         };
         }); 
        });

        // 初始化图例交互
        function initLegendInteraction() {
            const legendItems = document.querySelectorAll('.legend-item');            
            legendItems.forEach((item, index) => {
                const colorBlock = item.querySelector('.legend-color');
                const originalColor = colorBlock.style.backgroundColor;                
                // 悬停高亮对应层级
                item.addEventListener('mouseover', () => {
                    // 添加视觉反馈
                    item.style.transform = 'translateX(-5px)';
                    colorBlock.style.transform = 'scale(1.2)'                    
                    // 高亮对应系列
                    chart.dispatchAction({
                        type: 'highlight',
                        seriesIndex: index
                    });
                });
                
                item.addEventListener('mouseout', () => {
                    if (!item.classList.contains('active')) {
                        item.style.transform = 'none';
                        colorBlock.style.transform = 'none';                        
                        chart.dispatchAction({
                            type: 'downplay',
                            seriesIndex: index
                        });
                    }
                });

                // 点击聚焦/取消聚焦
                item.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isActive = item.classList.toggle('active');                    
                    if (isActive) {
                        // 显示对应系列并隐藏其他
                        option.series.forEach((series, i) => {
                            series.data.forEach(d => {
                                d.itemStyle = d.itemStyle || {};
                                d.itemStyle.opacity = i === index ? 1 : 0.2;
                            });
                        });
                    } else {
                        // 恢复所有系列
                        option.series.forEach(series => {
                            series.data.forEach(d => {
                                d.itemStyle.opacity = 1;
                            });
                        });
                    }                   
                    chart.setOption(option);
                });
            });
        }

        // 在图表初始化后调用
        initLegendInteraction();
        // 提示框交互优化
        let currentAdvice = null;
        
        chart.on('click', params => {
            const adviceBox = document.getElementById('adviceBox');
            
            if(currentAdvice !== params.name) {
                adviceBox.classList.remove('show');
                setTimeout(() => {
                    if (params.data?.advice) {
                                adviceBox.innerHTML =`<h3 style="margin:0 0 10px 0;color:#9C8C6B;">${params.name}</h3>${params.data.advice}`;
                        adviceBox.classList.add('show');
                        // 添加粒子特效
                        createParticles(params.event.event);
                    }
                    currentAdvice = params.name;
                }, 200);
            }
             // 同步图例状态
            const legendItems = document.querySelectorAll('.legend-item');
            legendItems.forEach(item => item.classList.remove('active'));
                });
        document.addEventListener('click', (e) => {
            if (!e.target.closest('#legend') && !e.target.closest('#chart')) {
                // 移除所有图例激活状态
                document.querySelectorAll('.legend-item').forEach(item => {
                    item.classList.remove('active'); 
                });
                
                // 恢复所有系列透明度
                option.series.forEach(series => {
                    series.data.forEach(d => {
                        d.itemStyle.opacity = 1;
                    });
                });
                chart.setOption(option);
            }
        });
        // 点击其他区域以及点击背景处关闭提示
        document.addEventListener('mousedown', (e) => {
            const adviceBox = document.getElementById('adviceBox');
            const chart = document.getElementById('chart');
            
            // 如果点击的目标不是提示框，并且也不是图表本身或者图表的子元素，并且也不是背景
            if (!adviceBox.contains(e.target) && !chart.contains(e.target) && e.target !== document.documentElement && e.target !== document.body) {
                adviceBox.style.display = 'none';
            }
            
            // 如果点击的是背景（html或body元素），也关闭提示框
            if (e.target === document.documentElement || e.target === document.body) {
                adviceBox.style.display = 'none';
            }
        });
        // 窗口调整时重绘图表
        window.addEventListener('resize', () => chart.resize());
        
        // 粒子特效函数
        function createParticles(event) {
            const colors = ['#E5D7B6', '#9C8C6B', '#A19D6E'];
            for(let i=0; i<8; i++) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: fixed;
                    width: 25px;
                    height: 25px;
                    background: ${colors[i%3]};
                    border-radius: 50%;
                    pointer-events: none;
                    left: ${event.clientX}px;
                    top: ${event.clientY}px;
                            animation: particle 1s ease-out;z-index:20000
                `;
        document.body.appendChild(particle);
        setTimeout(() => particle.remove(), 1000);
    }
}

        // 添加粒子动画
        const style = document.createElement('style');
        style.textContent = `
        @keyframes particle {
            0% { transform: translate(0,0); opacity: 1; }
                    100% { transform: translate(${Math.random()*100-50}px, ${Math.random()*100-50}px); opacity: 0; }
        }
        `;
        document.head.appendChild(style);

        document.querySelectorAll('.seasonal-guide td').forEach(item => {
            item.addEventListener('mouseenter', function() {
                this.style.transform = 'rotate(3deg) scale(1.1)';
                this.style.zIndex = 1001;
                anime({
                    targets: this,
                    scale: [1, 1.15],
                    rotate: () => anime.random(-5, 5),
                    duration: 800,
                    easing: 'easeOutElastic(1, .5)'
                });
            });
            
            item.addEventListener('mouseleave', function() {
                this.style.transform = 'rotate(0deg) scale(1)';
                this.style.zIndex = 'auto';
            });
        });
        setTimeout(() => {
                controls = new THREE.TrackballControls(camera, renderer.domElement);
                controls.rotateSpeed = 1.2;
                controls.minDistance = 500;
                controls.maxDistance = 4000;
                controls.addEventListener('change', render);
            }, 100);
            //导航
            document.addEventListener('DOMContentLoaded', () => {
            const navTrigger = document.getElementById('navTrigger');
            const sideMenu = document.getElementById('sideMenu');
            // 点击导航按钮
            navTrigger.addEventListener('click', (e) => {
                e.stopPropagation();
                sideMenu.classList.toggle('active');
                navTrigger.style.transform = 'scale(0.8)';
                setTimeout(() => navTrigger.style.transform = '', 200);
            });
        })
        
        // 动态设置rem基准值
        function setRemUnit() {
            const htmlElement = document.documentElement;
            const width = window.innerWidth;
            // 基于屏幕宽度动态计算基准字体大小
            let fontSize = 16; // 默认字体大小
            if (width <= 480) {
                fontSize = 12;
            } else if (width <= 768) {
                fontSize = 14;
            }
            htmlElement.style.fontSize = fontSize + 'px';
        }

        // 初始设置
        setRemUnit();

        const resizeObserver = new ResizeObserver(entries => {
            requestAnimationFrame(() => {
                updateChartLayout();
                chart.resize();
            });
        });
        resizeObserver.observe(document.getElementById('chart'));
    </script>
    
</body>
</html>